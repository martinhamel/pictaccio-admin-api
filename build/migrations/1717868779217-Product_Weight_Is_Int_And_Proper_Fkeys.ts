import { MigrationInterface, QueryRunner } from "typeorm";

export class ProductWeightIsIntAndProperFkeys1717868779217 implements MigrationInterface {
    name = 'ProductWeightIsIntAndProperFkeys1717868779217'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" DROP CONSTRAINT "FK_1b0fe441f520a4f3963e60ba4ee"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" DROP CONSTRAINT "FK_92f26e2487366389647a05a0696"`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_themes" DROP CONSTRAINT "FK_e66dc8fbd7083da0f9394451a38"`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_customs" DROP CONSTRAINT "FK_0c931c72554324eea0d7aea4dd4"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP CONSTRAINT "FK_02f7c9972c12ee9a155bcb53775"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP CONSTRAINT "FK_9a5f6868c96e0069e699f33e124"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP CONSTRAINT "FK_c2ef038c5b16485c916206e6614"`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" DROP CONSTRAINT "FK_25f2533b728fa5307cf212076e6"`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" DROP CONSTRAINT "FK_d0ca141e4a74512b14d2ced87b3"`);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" DROP CONSTRAINT "FK_1641cb1733f8c5e8fa1ddc48428"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" DROP CONSTRAINT "FK_0d991e7d5a39ab52a4fb0d796d0"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" DROP CONSTRAINT "FK_8d768c9bb463fa40aaeaec3183a"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" DROP CONSTRAINT "FK_4c675567d2a58f0b07cef09c13d"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" DROP CONSTRAINT "FK_9bb41adf4431f6de42c79c4d305"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_statuses" DROP CONSTRAINT "FK_3ea5b2fdf48f16b209b65e73812"`);
        await queryRunner.query(`ALTER TABLE "transactional"."subject_groups" DROP CONSTRAINT "FK_63303b125c10fbf6b8b68746dff"`);
        await queryRunner.query(`ALTER TABLE "transactional"."transactions" DROP CONSTRAINT "FK_3cb0558ed36997f1d9ecc1118e7"`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" DROP CONSTRAINT "FK_382ec81f8325ade1575566bc247"`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" DROP CONSTRAINT "FK_4a911af0c90c68d0d98e491cc53"`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" DROP CONSTRAINT "FK_888a3cde613b4715d58b6fe3f50"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" DROP CONSTRAINT "FK_2879b5a864ad805fe7332f68346"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" DROP CONSTRAINT "FK_3bd89f7a0b002650a06fe8b8797"`);
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" DROP CONSTRAINT "FK_661c8ba3e4b0a06d4d674be9afd"`);
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" DROP CONSTRAINT "FK_98dcaf14558d13f98e1892b0231"`);
        await queryRunner.query(`DROP INDEX "admin"."order_published_photos_order_id_fkey"`);
        await queryRunner.query(`DROP INDEX "admin"."order_published_photos_subject_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."product_type_themes_theme_set_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."product_type_customs_custom_template_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."products_category_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."products_theme_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."products_custom_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."sessions_product_crosssell_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."sessions_workflow_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."subjects_session_id_fkey"`);
        await queryRunner.query(`DROP INDEX "admin"."order_checks_order_id_fkey"`);
        await queryRunner.query(`DROP INDEX "admin"."order_checks_subject_id_fkey"`);
        await queryRunner.query(`DROP INDEX "admin"."comments_order_id_fkey"`);
        await queryRunner.query(`DROP INDEX "admin"."comments_user_id_fkey"`);
        await queryRunner.query(`DROP INDEX "admin"."order_statuses_order_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."subject_groups_session_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."transactions_order_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."orders_contact_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."orders_delivery_option_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."orders_session_id_fkey"`);
        await queryRunner.query(`DROP INDEX "admin"."order_assignments_user_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."promo_codes_campaign_id_fkey"`);
        await queryRunner.query(`DROP INDEX "transactional"."promo_codes_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP COLUMN "weight"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD "weight" integer NOT NULL`);
        await queryRunner.query(`DROP INDEX "transactional"."subjects_display_name_idx"`);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" DROP COLUMN "display_name"`);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","display_name","pictaccio_fake","transactional","subjects"]);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" ADD "display_name" text GENERATED ALWAYS AS ((info->>'firstName')::text || ' ' || (info->>'lastName')::text) STORED NOT NULL`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","transactional","subjects","GENERATED_COLUMN","display_name","(info->>'firstName')::text || ' ' || (info->>'lastName')::text"]);
        await queryRunner.query(`DROP INDEX "transactional"."contacts_name_idx"`);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" DROP COLUMN "name"`);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","name","pictaccio_fake","transactional","contacts"]);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" ADD "name" text GENERATED ALWAYS AS (first_name || ' ' || last_name) STORED NOT NULL`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","transactional","contacts","GENERATED_COLUMN","name","first_name || ' ' || last_name"]);
        await queryRunner.query(`DROP INDEX "transactional"."contacts_first_name_idx"`);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" DROP COLUMN "phone_digits"`);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","phone_digits","pictaccio_fake","transactional","contacts"]);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" ADD "phone_digits" text GENERATED ALWAYS AS (regexp_replace(phone, '[^\\d]+', '', 'g')) STORED NOT NULL`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","transactional","contacts","GENERATED_COLUMN","phone_digits","regexp_replace(phone, '[^\\\\d]+', '', 'g')"]);
        await queryRunner.query(`DROP INDEX "public"."app_integrations_active_idx"`);
        await queryRunner.query(`ALTER TABLE "app_integrations" DROP COLUMN "active"`);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","active","pictaccio_fake","public","app_integrations"]);
        await queryRunner.query(`ALTER TABLE "app_integrations" ADD "active" boolean GENERATED ALWAYS AS ((configuration->>'active')::boolean) STORED NOT NULL`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","public","app_integrations","GENERATED_COLUMN","active","(configuration->>'active')::boolean"]);
        await queryRunner.query(`CREATE INDEX "subjects_display_name_idx" ON "transactional"."subjects" ("display_name") `);
        await queryRunner.query(`CREATE INDEX "contacts_name_idx" ON "transactional"."contacts" ("name") `);
        await queryRunner.query(`CREATE INDEX "contacts_first_name_idx" ON "transactional"."contacts" ("phone_digits") `);
        await queryRunner.query(`CREATE INDEX "app_integrations_active_idx" ON "app_integrations" ("active") `);
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" ADD CONSTRAINT "order_published_photos_order_id_fkey" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" ADD CONSTRAINT "order_published_photos_subject_id_fkey" FOREIGN KEY ("subject_id") REFERENCES "transactional"."subjects"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_themes" ADD CONSTRAINT "product_type_themes_theme_set_id_fkey" FOREIGN KEY ("theme_set_id") REFERENCES "transactional"."product_theme_sets"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_customs" ADD CONSTRAINT "product_type_customs_custom_template_id_fkey" FOREIGN KEY ("custom_template_id") REFERENCES "transactional"."product_custom_templates"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD CONSTRAINT "products_category_id_fkey" FOREIGN KEY ("category_id") REFERENCES "transactional"."product_categories"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD CONSTRAINT "products_theme_id_fkey" FOREIGN KEY ("theme_id") REFERENCES "transactional"."product_type_themes"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD CONSTRAINT "products_custom_id_fkey" FOREIGN KEY ("custom_id") REFERENCES "transactional"."product_type_customs"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" ADD CONSTRAINT "sessions_product_crosssell_fkey" FOREIGN KEY ("product_crosssell_id") REFERENCES "transactional"."product_crosssells"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" ADD CONSTRAINT "sessions_workflow_fkey" FOREIGN KEY ("workflow_id") REFERENCES "transactional"."workflows"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" ADD CONSTRAINT "subjects_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "transactional"."sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" ADD CONSTRAINT "order_checks_order_id_fkey" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" ADD CONSTRAINT "order_checks_subject_id_fkey" FOREIGN KEY ("subject_id") REFERENCES "transactional"."subjects"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" ADD CONSTRAINT "comments_order_id_fkey" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" ADD CONSTRAINT "comments_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "admin"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_statuses" ADD CONSTRAINT "order_statuses_order_id_fkey" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."subject_groups" ADD CONSTRAINT "subject_groups_session_fkey" FOREIGN KEY ("session_id") REFERENCES "transactional"."sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."transactions" ADD CONSTRAINT "transactions_order_id_fkey" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" ADD CONSTRAINT "orders_contact_id_fkey" FOREIGN KEY ("contact_id") REFERENCES "transactional"."contacts"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" ADD CONSTRAINT "orders_delivery_option_id_fkey" FOREIGN KEY ("delivery_option_id") REFERENCES "transactional"."delivery_options"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" ADD CONSTRAINT "orders_session_id_fkey" FOREIGN KEY ("session_id") REFERENCES "transactional"."sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" ADD CONSTRAINT "order_assignments_order_id_fkey" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" ADD CONSTRAINT "order_assignments_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "admin"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" ADD CONSTRAINT "promo_codes_campaign_id_fkey" FOREIGN KEY ("campaign_id") REFERENCES "transactional"."promo_code_campaigns"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" ADD CONSTRAINT "promo_codes_order_id_fkey" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" DROP CONSTRAINT "promo_codes_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" DROP CONSTRAINT "promo_codes_campaign_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" DROP CONSTRAINT "order_assignments_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" DROP CONSTRAINT "order_assignments_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" DROP CONSTRAINT "orders_session_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" DROP CONSTRAINT "orders_delivery_option_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" DROP CONSTRAINT "orders_contact_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."transactions" DROP CONSTRAINT "transactions_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."subject_groups" DROP CONSTRAINT "subject_groups_session_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_statuses" DROP CONSTRAINT "order_statuses_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" DROP CONSTRAINT "comments_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" DROP CONSTRAINT "comments_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" DROP CONSTRAINT "order_checks_subject_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" DROP CONSTRAINT "order_checks_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" DROP CONSTRAINT "subjects_session_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" DROP CONSTRAINT "sessions_workflow_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" DROP CONSTRAINT "sessions_product_crosssell_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP CONSTRAINT "products_custom_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP CONSTRAINT "products_theme_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP CONSTRAINT "products_category_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_customs" DROP CONSTRAINT "product_type_customs_custom_template_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_themes" DROP CONSTRAINT "product_type_themes_theme_set_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" DROP CONSTRAINT "order_published_photos_subject_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" DROP CONSTRAINT "order_published_photos_order_id_fkey"`);
        await queryRunner.query(`DROP INDEX "public"."app_integrations_active_idx"`);
        await queryRunner.query(`DROP INDEX "transactional"."contacts_first_name_idx"`);
        await queryRunner.query(`DROP INDEX "transactional"."contacts_name_idx"`);
        await queryRunner.query(`DROP INDEX "transactional"."subjects_display_name_idx"`);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","active","pictaccio_fake","public","app_integrations"]);
        await queryRunner.query(`ALTER TABLE "app_integrations" DROP COLUMN "active"`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","public","app_integrations","GENERATED_COLUMN","active",""]);
        await queryRunner.query(`ALTER TABLE "app_integrations" ADD "active" boolean NOT NULL`);
        await queryRunner.query(`CREATE INDEX "app_integrations_active_idx" ON "app_integrations" ("active") `);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","phone_digits","pictaccio_fake","transactional","contacts"]);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" DROP COLUMN "phone_digits"`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","transactional","contacts","GENERATED_COLUMN","phone_digits",""]);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" ADD "phone_digits" text NOT NULL`);
        await queryRunner.query(`CREATE INDEX "contacts_first_name_idx" ON "transactional"."contacts" ("phone_digits") `);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","name","pictaccio_fake","transactional","contacts"]);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" DROP COLUMN "name"`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","transactional","contacts","GENERATED_COLUMN","name",""]);
        await queryRunner.query(`ALTER TABLE "transactional"."contacts" ADD "name" text NOT NULL`);
        await queryRunner.query(`CREATE INDEX "contacts_name_idx" ON "transactional"."contacts" ("name") `);
        await queryRunner.query(`DELETE FROM "public"."typeorm_metadata" WHERE "type" = $1 AND "name" = $2 AND "database" = $3 AND "schema" = $4 AND "table" = $5`, ["GENERATED_COLUMN","display_name","pictaccio_fake","transactional","subjects"]);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" DROP COLUMN "display_name"`);
        await queryRunner.query(`INSERT INTO "public"."typeorm_metadata"("database", "schema", "table", "type", "name", "value") VALUES ($1, $2, $3, $4, $5, $6)`, ["pictaccio_fake","transactional","subjects","GENERATED_COLUMN","display_name",""]);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" ADD "display_name" text NOT NULL`);
        await queryRunner.query(`CREATE INDEX "subjects_display_name_idx" ON "transactional"."subjects" ("display_name") `);
        await queryRunner.query(`ALTER TABLE "transactional"."products" DROP COLUMN "weight"`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD "weight" text NOT NULL`);
        await queryRunner.query(`CREATE INDEX "promo_codes_order_id_fkey" ON "transactional"."promo_codes" ("order_id") `);
        await queryRunner.query(`CREATE INDEX "promo_codes_campaign_id_fkey" ON "transactional"."promo_codes" ("campaign_id") `);
        await queryRunner.query(`CREATE INDEX "order_assignments_user_id_fkey" ON "admin"."order_assignments" ("user_id") `);
        await queryRunner.query(`CREATE INDEX "orders_session_id_fkey" ON "transactional"."orders" ("session_id") `);
        await queryRunner.query(`CREATE INDEX "orders_delivery_option_id_fkey" ON "transactional"."orders" ("delivery_option_id") `);
        await queryRunner.query(`CREATE INDEX "orders_contact_id_fkey" ON "transactional"."orders" ("contact_id") `);
        await queryRunner.query(`CREATE INDEX "transactions_order_id_fkey" ON "transactional"."transactions" ("order_id") `);
        await queryRunner.query(`CREATE INDEX "subject_groups_session_fkey" ON "transactional"."subject_groups" ("session_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "order_statuses_order_id_fkey" ON "admin"."order_statuses" ("order_id") `);
        await queryRunner.query(`CREATE INDEX "comments_user_id_fkey" ON "admin"."order_comments" ("user_id") `);
        await queryRunner.query(`CREATE INDEX "comments_order_id_fkey" ON "admin"."order_comments" ("order_id") `);
        await queryRunner.query(`CREATE INDEX "order_checks_subject_id_fkey" ON "admin"."order_checks" ("subject_id") `);
        await queryRunner.query(`CREATE INDEX "order_checks_order_id_fkey" ON "admin"."order_checks" ("order_id") `);
        await queryRunner.query(`CREATE INDEX "subjects_session_id_fkey" ON "transactional"."subjects" ("session_id") `);
        await queryRunner.query(`CREATE INDEX "sessions_workflow_fkey" ON "transactional"."sessions" ("workflow_id") `);
        await queryRunner.query(`CREATE INDEX "sessions_product_crosssell_fkey" ON "transactional"."sessions" ("product_crosssell_id") `);
        await queryRunner.query(`CREATE INDEX "products_custom_id_fkey" ON "transactional"."products" ("custom_id") `);
        await queryRunner.query(`CREATE INDEX "products_theme_id_fkey" ON "transactional"."products" ("theme_id") `);
        await queryRunner.query(`CREATE INDEX "products_category_id_fkey" ON "transactional"."products" ("category_id") `);
        await queryRunner.query(`CREATE INDEX "product_type_customs_custom_template_id_fkey" ON "transactional"."product_type_customs" ("custom_template_id") `);
        await queryRunner.query(`CREATE INDEX "product_type_themes_theme_set_id_fkey" ON "transactional"."product_type_themes" ("theme_set_id") `);
        await queryRunner.query(`CREATE INDEX "order_published_photos_subject_id_fkey" ON "admin"."order_published_photos" ("subject_id") `);
        await queryRunner.query(`CREATE INDEX "order_published_photos_order_id_fkey" ON "admin"."order_published_photos" ("order_id") `);
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" ADD CONSTRAINT "FK_98dcaf14558d13f98e1892b0231" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."promo_codes" ADD CONSTRAINT "FK_661c8ba3e4b0a06d4d674be9afd" FOREIGN KEY ("campaign_id") REFERENCES "transactional"."promo_code_campaigns"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" ADD CONSTRAINT "FK_3bd89f7a0b002650a06fe8b8797" FOREIGN KEY ("user_id") REFERENCES "admin"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_assignments" ADD CONSTRAINT "FK_2879b5a864ad805fe7332f68346" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" ADD CONSTRAINT "FK_888a3cde613b4715d58b6fe3f50" FOREIGN KEY ("delivery_option_id") REFERENCES "transactional"."delivery_options"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" ADD CONSTRAINT "FK_4a911af0c90c68d0d98e491cc53" FOREIGN KEY ("session_id") REFERENCES "transactional"."sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."orders" ADD CONSTRAINT "FK_382ec81f8325ade1575566bc247" FOREIGN KEY ("contact_id") REFERENCES "transactional"."contacts"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."transactions" ADD CONSTRAINT "FK_3cb0558ed36997f1d9ecc1118e7" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."subject_groups" ADD CONSTRAINT "FK_63303b125c10fbf6b8b68746dff" FOREIGN KEY ("session_id") REFERENCES "transactional"."sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_statuses" ADD CONSTRAINT "FK_3ea5b2fdf48f16b209b65e73812" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" ADD CONSTRAINT "FK_9bb41adf4431f6de42c79c4d305" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_comments" ADD CONSTRAINT "FK_4c675567d2a58f0b07cef09c13d" FOREIGN KEY ("user_id") REFERENCES "admin"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" ADD CONSTRAINT "FK_8d768c9bb463fa40aaeaec3183a" FOREIGN KEY ("subject_id") REFERENCES "transactional"."subjects"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_checks" ADD CONSTRAINT "FK_0d991e7d5a39ab52a4fb0d796d0" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."subjects" ADD CONSTRAINT "FK_1641cb1733f8c5e8fa1ddc48428" FOREIGN KEY ("session_id") REFERENCES "transactional"."sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" ADD CONSTRAINT "FK_d0ca141e4a74512b14d2ced87b3" FOREIGN KEY ("workflow_id") REFERENCES "transactional"."workflows"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."sessions" ADD CONSTRAINT "FK_25f2533b728fa5307cf212076e6" FOREIGN KEY ("product_crosssell_id") REFERENCES "transactional"."product_crosssells"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD CONSTRAINT "FK_c2ef038c5b16485c916206e6614" FOREIGN KEY ("custom_id") REFERENCES "transactional"."product_type_customs"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD CONSTRAINT "FK_9a5f6868c96e0069e699f33e124" FOREIGN KEY ("category_id") REFERENCES "transactional"."product_categories"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."products" ADD CONSTRAINT "FK_02f7c9972c12ee9a155bcb53775" FOREIGN KEY ("theme_id") REFERENCES "transactional"."product_type_themes"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_customs" ADD CONSTRAINT "FK_0c931c72554324eea0d7aea4dd4" FOREIGN KEY ("custom_template_id") REFERENCES "transactional"."product_custom_templates"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactional"."product_type_themes" ADD CONSTRAINT "FK_e66dc8fbd7083da0f9394451a38" FOREIGN KEY ("theme_set_id") REFERENCES "transactional"."product_theme_sets"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" ADD CONSTRAINT "FK_92f26e2487366389647a05a0696" FOREIGN KEY ("subject_id") REFERENCES "transactional"."subjects"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "admin"."order_published_photos" ADD CONSTRAINT "FK_1b0fe441f520a4f3963e60ba4ee" FOREIGN KEY ("order_id") REFERENCES "transactional"."orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

}
